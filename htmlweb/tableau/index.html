<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <title>JavaScript fetch()</title>

    <script type="text/javascript">
    </script>
</head>

<body class="col-md-12">
    <h1>Recup des donn√©es elastic</h1>
    <div>
        <p>En attente.</p>
        <a href="#" class="btn btn-primary" onclick="loadfetchCity()">loadfetchCity</a>
    </div>

    <div id="content">
        <select id="locality-dropdown" name="locality">
        </select>
    </div>

    <div id="display-resources">
    </div>





    <script>
        function loadfetchCity() {
            let displayResources = document.querySelector("#display-resources");
            displayResources.textContent =
                "Loading data from JSON source...";
            fetch(
                    "https://geo.api.gouv.fr/departements/13/communes?fields=nom,code,codesPostaux,codeDepartement,codeRegion,population&format=json&geometry=centre")

                .then(function (response) {
                    if (response.ok)
                        return response.json();
                    throw new Error('Response is not OK');
                })
                .then(function (result) {
                    let output =
                        "<table class='table table-striped'><thead><tr><th scope='col'>Name</th><th scope='col'>Provider</th><th>URL</th></thead><tbody>";
                    for (let i in result) {
                        output +=
                            "<tr><td>" +
                            result[i].code +
                            "</td><td>" +
                            result[i].nom +
                            "</td><td>" +
                            result[i].population +
                            "</td></tr>";
                    }
                    output += "</tbody></table>";
                    displayResources.innerHTML = output;
                })
                .catch(function (error) {
                    console.log(error);
                });
        };


        let dropdown = document.getElementById('locality-dropdown');
dropdown.length = 0;

let defaultOption = document.createElement('option');
defaultOption.text = 'Choose State/Province';

dropdown.add(defaultOption);
dropdown.selectedIndex = 0;

const url = 'https://pokeapi.co/api/v2/pokemon';

fetch(url)  
  .then(  
    function(response) {  
      if (response.status !== 200) {  
        console.warn('Looks like there was a problem. Status Code: ' + 
          response.status);  
        return;  
      }

      // Examine the text in the response  
      response.json().then(function(data) {  
      //  data=data.results;
    console.log(response);
        let option;
      
    	for (let i = 0; i < data.results.length; i++) {
          option = document.createElement('option');
      	  option.text = data.results[i].name;
      	//  option.value = data[i].abbreviation;
      	  dropdown.add(option);
    	}    
      });  
    }  
  )  
  .catch(function(err) {  
    console.error('Fetch Error -', err);  
  });




    </script>


</body>

</html>